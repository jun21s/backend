<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>프로젝트 등록</title>
</head>

<body>
    <h1>프로젝트 등록</h1>
    <form action="/api/project/create" method="post" enctype="application/x-www-form-urlencoded">
        <label for="projectName">프로젝트 이름:</label>
        <input type="text" id="projectName" name="projectName" required /><br />

        <label for="fieldId">분야 ID:</label>
        <input type="number" id="fieldId" name="fieldId" required /><br />
        <!-- 여기도 기술 스텍처럼 체크박스로 하는게 좋을듯 -->


        <label for="area">지역:</label>
        <select id="area" name="area">
            <option value="seoul">서울</option>
            <option value="busan">부산</option>
            <option value="jeju">제주도</option>
        </select><br />
        <!-- 아직은 모든 지역들 다 안넣었음 -->


        <label for="description">설명:</label>
        <textarea id="description" name="description"></textarea><br />

        <label for="startDate">시작일:</label>
        <input type="date" id="startDate" name="startDate" /><br />

        <label for="endDate">종료일:</label>
        <input type="date" id="endDate" name="endDate" /><br />

        <!-- <label for="status">상태:</label>
        <select id="status" name="status">
            <option value="ready">준비중</option>
            <option value="ongoing">진행중</option>
            <option value="finished">완료</option>
        </select><br /> -->

        <label for="leader">프로젝트 리더 이메일:</label>
        <input type="email" id="leader" name="leader" /><br />
        <!-- 지금은 입력 창이지만 등록하는 사람의 id=email을 들고와서 바로 하는것도 좋을듯 -->

        <button type="submit">등록하기</button>
        <button type="button">취소하기</button>
    </form>
    <script>
        fetch("/api/auth/techStack")
            .then((response) => response.json())
            .then((techStackData) => {
                const techStackCheckboxes = document.getElementById(
                    "techStackCheckboxes"
                );

                techStackData.techStack.forEach((tech) => {
                    const checkbox = document.createElement("input");
                    checkbox.type = "checkbox";
                    checkbox.name = "techs";
                    checkbox.value = tech;
                    checkbox.id = tech;

                    const label = document.createElement("label");
                    label.setAttribute("for", tech);
                    label.textContent = tech;

                    techStackCheckboxes.appendChild(checkbox);
                    techStackCheckboxes.appendChild(label);
                    techStackCheckboxes.appendChild(document.createElement("br"));
                });

                const maxTechStack = 5; // 최대 선택 가능한 기술스택 수

                const checkboxes = document.querySelectorAll('input[name="techs"]');
                let selectedCount = 0;

                checkboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        selectedCount = document.querySelectorAll('input[name="techs"]:checked').length;

                        if (selectedCount > maxTechStack) {
                            alert(`최대 ${maxTechStack}개까지 선택할 수 있습니다.`);
                            checkbox.checked = false;
                        }
                    });
                });
            })
            .catch((error) => {
                console.error("Error fetching tech stack:", error);
            });
    </script>
</body>

</html>